.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{
.    if \nF \{
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SA-UPDATE 1"
.TH SA-UPDATE 1 "2018-09-12" "perl v5.18.2" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
sa\-update \- automate SpamAssassin rule updates
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBsa-update\fR [options]
.PP
Options:
.PP
.Vb 10
\&  \-\-channel channel       Retrieve updates from this channel
\&                          Use multiple times for multiple channels
\&  \-\-channelfile file      Retrieve updates from the channels in the file
\&  \-\-checkonly             Check for update availability, do not install
\&  \-\-install filename      Install updates directly from this file. Signature
\&                          verification will use "file.asc" and "file.sha1"
\&  \-\-allowplugins          Allow updates to load plugin code
\&  \-\-gpgkey key            Trust the key id to sign releases
\&                          Use multiple times for multiple keys
\&  \-\-gpgkeyfile file       Trust the key ids in the file to sign releases
\&  \-\-gpghomedir path       Store the GPG keyring in this directory
\&  \-\-gpg and \-\-nogpg       Use (or do not use) GPG to verify updates
\&                          (\-\-gpg is assumed by use of the above
\&                          \-\-gpgkey and \-\-gpgkeyfile options)
\&  \-\-import file           Import GPG key(s) from file into sa\-update\*(Aqs
\&                          keyring. Use multiple times for multiple files
\&  \-\-updatedir path        Directory to place updates, defaults to the
\&                          SpamAssassin site rules directory
\&                          (default: /Library/Server/Mail/Data/scanner/spamassassin/3.004001)
\&  \-\-refreshmirrors        Force the MIRRORED.BY file to be updated
\&  \-D, \-\-debug [area=n,...]  Print debugging messages
\&  \-v, \-\-verbose           Be verbose, like print updated channel names;
\&                          For more verbosity specify multiple times
\&  \-V, \-\-version           Print version
\&  \-h, \-\-help              Print usage message
\&  \-4                      Force using the inet protocol (IPv4), not inet6
\&  \-6                      Force using the inet6 protocol (IPv6), not inet
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
sa-update automates the process of downloading and installing new rules and
configuration, based on channels.  The default channel is
\&\fIupdates.spamassassin.org\fR, which has updated rules since the previous
release.
.PP
Update archives are verified using \s-1SHA1\s0 hashes and \s-1GPG\s0 signatures, by default.
.PP
Note that \f(CW\*(C`sa\-update\*(C'\fR will not restart \f(CW\*(C`spamd\*(C'\fR or otherwise cause
a scanner to reload the now-updated ruleset automatically.  Instead,
\&\f(CW\*(C`sa\-update\*(C'\fR is typically used in something like the following manner:
.PP
.Vb 1
\&        sa\-update && /etc/init.d/spamassassin reload
.Ve
.PP
This works because \f(CW\*(C`sa\-update\*(C'\fR only returns an exit status of \f(CW0\fR if
it has successfully downloaded and installed an updated ruleset.
.PP
The program sa-update uses the underlying operating system umask for the
updated rule files it installs.  You may wish to run sa-update from a script
that sets the umask prior to calling sa-update.  For example:
.PP
.Vb 3
\&        #!/bin/sh
\&        umask 022
\&        sa\-update
.Ve
.SH "OPTIONS"
.IX Header "OPTIONS"
.IP "\fB\-\-channel\fR" 4
.IX Item "--channel"
sa-update can update multiple channels at the same time.  By default, it will
only access \*(L"updates.spamassassin.org\*(R", but more channels can be specified via
this option.  If there are multiple additional channels, use the option
multiple times, once per channel.  i.e.:
.Sp
.Vb 1
\&        sa\-update \-\-channel foo.example.com \-\-channel bar.example.com
.Ve
.IP "\fB\-\-channelfile\fR" 4
.IX Item "--channelfile"
Similar to the \fB\-\-channel\fR option, except specify the additional channels in a
file instead of on the commandline.  This is useful when there are a
lot of additional channels.
.IP "\fB\-\-checkonly\fR" 4
.IX Item "--checkonly"
Only check if an update is available, don't actually download and install it.
The exit code will be \f(CW0\fR or \f(CW1\fR as described below.
.IP "\fB\-\-install\fR" 4
.IX Item "--install"
Install updates \*(L"offline\*(R", from the named tar.gz file, instead of performing
\&\s-1DNS\s0 lookups and \s-1HTTP\s0 invocations.
.Sp
Files named \fBfile\fR.sha1 and \fBfile\fR.asc will be used for the \s-1SHA\-1\s0 and \s-1GPG\s0
signature, respectively.  The filename provided must contain a version number
of at least 3 digits, which will be used as the channel's update version
number.
.Sp
Multiple \fB\-\-channel\fR switches cannot be used with \fB\-\-install\fR.  To install
multiple channels from tarballs, run \f(CW\*(C`sa\-update\*(C'\fR multiple times with different
\&\fB\-\-channel\fR and \fB\-\-install\fR switches, e.g.:
.Sp
.Vb 2
\&        sa\-update \-\-channel foo.example.com \-\-install foo\-34958.tgz
\&        sa\-update \-\-channel bar.example.com \-\-install bar\-938455.tgz
.Ve
.IP "\fB\-\-allowplugins\fR" 4
.IX Item "--allowplugins"
Allow downloaded updates to activate plugins.  The default is not to
activate plugins; any \f(CW\*(C`loadplugin\*(C'\fR or \f(CW\*(C`tryplugin\*(C'\fR lines will be commented
in the downloaded update rules files.
.IP "\fB\-\-gpg\fR, \fB\-\-nogpg\fR" 4
.IX Item "--gpg, --nogpg"
sa-update by default will verify update archives by use of a \s-1SHA1\s0 checksum
and \s-1GPG\s0 signature.  \s-1SHA1\s0 hashes can verify whether or not the downloaded
archive has been corrupted, but it does not offer any form of security
regarding whether or not the downloaded archive is legitimate (aka:
non-modifed by evildoers).  \s-1GPG\s0 verification of the archive is used to
solve that problem.
.Sp
If you wish to skip \s-1GPG\s0 verification, you can use the \fB\-\-nogpg\fR option
to disable its use.  Use of the following gpgkey-related options will
override \fB\-\-nogpg\fR and keep \s-1GPG\s0 verification enabled.
.Sp
Note: Currently, only \s-1GPG\s0 itself is supported (ie: not \s-1PGP\s0).  v1.2 has been
tested, although later versions ought to work as well.
.IP "\fB\-\-gpgkey\fR" 4
.IX Item "--gpgkey"
sa-update has the concept of \*(L"release trusted\*(R" \s-1GPG\s0 keys.  When an archive is
downloaded and the signature verified, sa-update requires that the signature
be from one of these \*(L"release trusted\*(R" keys or else verification fails.  This
prevents third parties from manipulating the files on a mirror, for instance,
and signing with their own key.
.Sp
By default, sa-update trusts key ids \f(CW\*(C`24F434CE\*(C'\fR and \f(CW\*(C`5244EC45\*(C'\fR, which are
the standard SpamAssassin release key and its sub-key.  Use this option to
trust additional keys.  See the \fB\-\-import\fR option for how to add keys to
sa-update's keyring.  For sa-update to use a key it must be in sa-update's
keyring and trusted.
.Sp
For multiple keys, use the option multiple times.  i.e.:
.Sp
.Vb 1
\&        sa\-update \-\-gpgkey E580B363 \-\-gpgkey 298BC7D0
.Ve
.Sp
Note: use of this option automatically enables \s-1GPG\s0 verification.
.IP "\fB\-\-gpgkeyfile\fR" 4
.IX Item "--gpgkeyfile"
Similar to the \fB\-\-gpgkey\fR option, except specify the additional keys in a file
instead of on the commandline.  This is extremely useful when there are a lot
of additional keys that you wish to trust.
.IP "\fB\-\-gpghomedir\fR" 4
.IX Item "--gpghomedir"
Specify a directory path to use as a storage area for the \f(CW\*(C`sa\-update\*(C'\fR \s-1GPG\s0
keyring.  By default, this is
.Sp
.Vb 1
\&        /Library/Server/Mail/Config/spamassassin/sa\-update\-keys
.Ve
.IP "\fB\-\-import\fR" 4
.IX Item "--import"
Use to import \s-1GPG\s0 key(s) from a file into the sa-update keyring which is
located in the directory specified by \fB\-\-gpghomedir\fR.  Before using channels
from third party sources, you should use this option to import the \s-1GPG\s0 key(s)
used by those channels.  You must still use the \fB\-\-gpgkey\fR or \fB\-\-gpgkeyfile\fR
options above to get sa-update to trust imported keys.
.Sp
To import multiple keys, use the option multiple times.  i.e.:
.Sp
.Vb 1
\&        sa\-update \-\-import channel1\-GPG.KEY \-\-import channel2\-GPG.KEY
.Ve
.Sp
Note: use of this option automatically enables \s-1GPG\s0 verification.
.IP "\fB\-\-refreshmirrors\fR" 4
.IX Item "--refreshmirrors"
Force the list of sa-update mirrors for each channel, stored in the \s-1MIRRORED.BY\s0
file, to be updated.  By default, the \s-1MIRRORED.BY\s0 file will be cached for up to
7 days after each time it is downloaded.
.IP "\fB\-\-updatedir\fR" 4
.IX Item "--updatedir"
By default, \f(CW\*(C`sa\-update\*(C'\fR will use the system-wide rules update directory:
.Sp
.Vb 1
\&        /Library/Server/Mail/Data/scanner/spamassassin/3.004001
.Ve
.Sp
If the updates should be stored in another location, specify it here.
.Sp
Note that use of this option is not recommended; if you're just using sa-update
to download updated rulesets for a scanner, and sa-update is placing updates in
the wrong directory, you probably need to rebuild SpamAssassin with different
\&\f(CW\*(C`Makefile.PL\*(C'\fR arguments, instead of overriding sa-update's runtime behaviour.
.IP "\fB\-D\fR [\fIarea,...\fR], \fB\-\-debug\fR [\fIarea,...\fR]" 4
.IX Item "-D [area,...], --debug [area,...]"
Produce debugging output.  If no areas are listed, all debugging information is
printed.  Diagnostic output can also be enabled for each area individually;
\&\fIarea\fR is the area of the code to instrument. For example, to produce
diagnostic output on channel, gpg, and http, use:
.Sp
.Vb 1
\&        sa\-update \-D channel,gpg,http
.Ve
.Sp
For more information about which areas (also known as channels) are
available, please see the documentation at
<http://wiki.apache.org/spamassassin/DebugChannels>.
.IP "\fB\-h\fR, \fB\-\-help\fR" 4
.IX Item "-h, --help"
Print help message and exit.
.IP "\fB\-V\fR, \fB\-\-version\fR" 4
.IX Item "-V, --version"
Print sa-update version and exit.
.SH "EXIT CODES"
.IX Header "EXIT CODES"
In absence of a \-\-checkonly option, an exit code of \f(CW0\fR means:
an update was available, and was downloaded and installed successfully.
If \-\-checkonly was specified, an exit code of \f(CW0\fR means: an update was
available.
.PP
An exit code of \f(CW1\fR means no fresh updates were available.
.PP
An exit code of \f(CW2\fR means that at least one update is available but that a
lint check of the site pre files failed.  The site pre files must pass a lint
check before any updates are attempted.
.PP
An exit code of \f(CW3\fR means that at least one update succeeded while 
other channels failed.  If using sa-compile, you should proceed with it.
.PP
An exit code of \f(CW4\fR or higher, indicates that errors occurred while
attempting to download and extract updates, and no channels were updated.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIMail::SpamAssassin\fR\|(3)
\&\fIMail::SpamAssassin::Conf\fR\|(3)
\&\fIspamassassin\fR\|(1)
\&\fIspamd\fR\|(1)
<http://wiki.apache.org/spamassassin/RuleUpdates>
.SH "PREREQUESITES"
.IX Header "PREREQUESITES"
\&\f(CW\*(C`Mail::SpamAssassin\*(C'\fR
.SH "BUGS"
.IX Header "BUGS"
See <http://issues.apache.org/SpamAssassin/>
.SH "AUTHORS"
.IX Header "AUTHORS"
The Apache SpamAssassin(tm) Project <http://spamassassin.apache.org/>
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
SpamAssassin is distributed under the Apache License, Version 2.0, as
described in the file \f(CW\*(C`LICENSE\*(C'\fR included with the distribution.
